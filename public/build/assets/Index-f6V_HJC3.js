import{r as c,a as m,j as e,H as be,L as N}from"./app-C7GeCeqo.js";import{A as we}from"./app-layout-D7W7jbGm.js";import{c as Se,B as n}from"./button-DUJ2hcPX.js";import{I as De}from"./input-b61IUe-d.js";import{S as q,a as J,b as U,c as W,d as u}from"./select-C4gCinrj.js";import{B as S}from"./badge-OZnWOJh7.js";import{C as v,a as Te,b as Fe,c as y}from"./card-BsXVudJB.js";import{C as Z}from"./checkbox-DiNa32u-.js";import{P as Ae,a as ke,b as Pe,c as Oe,d as ze,e as Ee,A as G,f as K,g as Q,h as X,i as Y,j as I,k as ee,l as se}from"./pagination-DzoSLNfM.js";import{T as D,P as te}from"./trash-2-C5fYadDa.js";import{F as $e}from"./filter-D0Nqj8gP.js";import{R as ae,S as le}from"./search-odIpKcIZ.js";import{S as Le,a as Be,E as Re}from"./star-CA5xkYVR.js";import{M as He}from"./map-pin-COOrTvaA.js";import{C as Ve}from"./calendar-DI2ODUFR.js";import{S as Me}from"./square-pen-Cr2QEx3C.js";/* empty css            */import"./index-BpyxFFCF.js";import"./index-C5Bs_mjf.js";import"./index-CJWcNj5i.js";import"./index-BZiUBkJp.js";import"./check-DEOZK67P.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],re=Se("FileText",qe),Je=[{title:"Dashboard",href:"/dashboard"},{title:"Cases",href:"/cases"}];function xs(ne){const{cases:o=null,caseTypes:ie={},filters:ce=null}=ne||{},oe=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(t){return console.error("Error parsing case translated content:",t,"Raw content:",s),{title:{en:"Untitled",ar:"بدون عنوان"},description:{en:"No description",ar:"لا يوجد وصف"},details:[],imagePath:null}}return s||{title:{en:"Untitled",ar:"بدون عنوان"},description:{en:"No description",ar:"لا يوجد وصف"},details:[],imagePath:null}},de=s=>{const t={};return Object.entries(s).forEach(([a,r])=>{if(typeof r=="string")try{t[a]=JSON.parse(r)}catch(w){console.error(`Error parsing case type ${a}:`,w),t[a]={en:a,ar:a}}else t[a]=r}),t},he=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(t){return console.error("Error parsing links:",t),[]}return Array.isArray(s)?s:[]},l={data:o?.data||[],links:he(o?.links||[]),meta:{current_page:o?.meta?.current_page||1,last_page:o?.meta?.last_page||1,total:o?.meta?.total||0,per_page:o?.meta?.per_page||12,from:o?.meta?.from||null,to:o?.meta?.to||null}},_=ce||{},T=de(ie),[d,F]=c.useState(_.search||""),[p,A]=c.useState(_.type||"__all__"),[f,k]=c.useState(_.featured||"__all__"),[i,x]=c.useState([]),[me,C]=c.useState(!1),[xe,b]=c.useState(!1),[P,O]=c.useState(null),[ue,pe]=c.useState(!0);c.useEffect(()=>{if(ue){pe(!1);return}const s=setTimeout(()=>{z()},300);return()=>clearTimeout(s)},[d]);const g=s=>s==="__all__"?"":s,z=()=>{const s={};d?.trim()&&(s.search=d.trim());const t=g(p);t&&(s.type=t);const a=g(f);a&&(s.featured=a),m.get("/cases",Object.keys(s).length>0?s:{},{preserveState:!0,preserveScroll:!0})},E=(s={})=>{const t={},a=s.search!==void 0?s.search:d,r=s.type!==void 0?s.type:p,w=s.featured!==void 0?s.featured:f;a?.trim()&&(t.search=a.trim());const V=g(r);V&&(t.type=V);const M=g(w);M&&(t.featured=M),m.get("/cases",Object.keys(t).length>0?t:{},{preserveState:!0,preserveScroll:!0})},$=()=>{F(""),A("__all__"),k("__all__"),m.get("/cases")},fe=s=>{s&&l.data.length>0?x(l.data.map(t=>t.id)):x([])},ge=(s,t)=>{x(t?a=>[...a,s]:a=>a.filter(r=>r!==s))},je=s=>{O(s),C(!0)},Ne=()=>{P&&m.delete(`/cases/${P}`),C(!1),O(null)},L=()=>{b(!0)},ve=()=>{i.length>0&&m.post("/cases/bulk-delete",{ids:i}),b(!1),x([])},ye=s=>{m.patch(`/cases/${s.id}/toggle-featured`,{},{preserveState:!0,preserveScroll:!0})},h=!!(d?.trim()||p!=="__all__"||f!=="__all__"),B=l.data.length===0||l.meta.total===0,j=l.meta.total,R=l.meta.from,H=l.meta.to,_e=()=>B&&!h?"No cases found. Create your first case to get started.":B&&h?"No results match your current filters.":R&&H?`Showing ${R} to ${H} of ${j} results`:j>0?`${j} case${j!==1?"s":""}`:"Loading cases...",Ce=()=>e.jsx(v,{className:"overflow-hidden",children:e.jsx(y,{className:"py-16",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:e.jsx(re,{className:"w-8 h-8 text-muted-foreground"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:h?"No cases found":"No cases yet"}),e.jsx("p",{className:"text-muted-foreground max-w-md mx-auto",children:h?"Try adjusting your filters to find what you're looking for.":"Create your first case to start documenting incidents."})]}),e.jsxs("div",{className:"flex justify-center gap-2 pt-4",children:[h&&e.jsxs(n,{variant:"outline",onClick:$,className:"gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Clear Filters"]}),e.jsx(N,{href:"/cases/create",children:e.jsxs(n,{className:"gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Create Case"]})})]})]})})});return e.jsxs(we,{breadcrumbs:Je,children:[e.jsx(be,{title:"Cases"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4 overflow-x-auto",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Cases"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:_e()})]}),e.jsxs("div",{className:"flex gap-2",children:[i.length>0&&e.jsxs(n,{variant:"destructive",onClick:L,size:"sm",className:"gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Delete Selected (",i.length,")"]}),e.jsx(N,{href:"/cases/create",children:e.jsxs(n,{size:"sm",className:"gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Create Case"]})})]})]}),e.jsxs(v,{className:"overflow-hidden",children:[e.jsx(Te,{className:"px-6 py-4 border-b",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4 text-muted-foreground"}),e.jsx(Fe,{className:"text-lg font-semibold",children:"Filters"})]}),h&&e.jsxs(n,{variant:"outline",size:"sm",onClick:$,className:"gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Clear Filters"]})]})}),e.jsx(y,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(De,{type:"text",placeholder:"Search cases...",value:d,onChange:s=>F(s.target.value),className:"pl-10"})]}),e.jsxs(q,{value:p,onValueChange:s=>{A(s),E({type:s})},children:[e.jsx(J,{children:e.jsx(U,{placeholder:"All Types"})}),e.jsxs(W,{children:[e.jsx(u,{value:"__all__",children:"All Types"}),Object.entries(T).map(([s,t])=>e.jsx(u,{value:s,children:t.en},s))]})]}),e.jsxs(q,{value:f,onValueChange:s=>{k(s),E({featured:s})},children:[e.jsx(J,{children:e.jsx(U,{placeholder:"All Items"})}),e.jsxs(W,{children:[e.jsx(u,{value:"__all__",children:"All Items"}),e.jsx(u,{value:"true",children:"Featured Only"}),e.jsx(u,{value:"false",children:"Not Featured"})]})]}),e.jsxs(n,{onClick:z,className:"gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),"Search"]})]})})]}),l.data.length===0?e.jsx(Ce,{}):e.jsxs(e.Fragment,{children:[i.length>0&&e.jsx(v,{children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{checked:i.length===l.data.length&&l.data.length>0,onCheckedChange:fe}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[i.length," of ",l.data.length," selected"]})]}),e.jsxs(n,{variant:"destructive",size:"sm",onClick:L,className:"gap-2",children:[e.jsx(D,{className:"w-4 h-4"}),"Delete Selected"]})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.data.map((s,t)=>{console.log(`Rendering case ${t+1}:`,s.id,s.case_id);const a=oe(s.translated_content);return console.log(`Case ${s.id} translated content:`,a),e.jsxs(v,{className:"overflow-hidden group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx(Z,{checked:i.includes(s.id),onCheckedChange:r=>ge(s.id,!!r)})}),e.jsx("button",{onClick:()=>ye(s),className:"absolute top-3 right-3 z-10 p-1 rounded-full bg-black/50 text-white opacity-0 group-hover:opacity-100 transition-opacity",children:s.is_featured?e.jsx(Le,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}):e.jsx(Be,{className:"w-4 h-4"})}),e.jsx("div",{className:"aspect-[4/3] bg-muted flex items-center justify-center",children:a.imagePath?e.jsx("img",{src:a.imagePath,alt:a.title?.en||"Case image",className:"w-full h-full object-cover",onError:r=>{console.error("Case image failed to load:",a.imagePath),r.currentTarget.style.display="none"}}):e.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[e.jsx(re,{className:"w-8 h-8"}),e.jsx("span",{className:"text-xs",children:"No image"})]})}),e.jsx("div",{className:"absolute bottom-3 left-3",children:e.jsx(S,{variant:"secondary",className:"capitalize",children:T[s.type]?.en||s.type})})]}),e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2",children:a.title?.en||s.case_id||"Untitled"}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:a.description?.en||"No description"}),e.jsxs("div",{className:"space-y-1",children:[s.location&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(He,{className:"w-3 h-3"}),s.location]}),s.incident_date&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Ve,{className:"w-3 h-3"}),new Date(s.incident_date).toLocaleDateString()]}),s.media_count>0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.media_count," media item",s.media_count!==1?"s":""]}),a.details&&a.details.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.details.length," detail",a.details.length!==1?"s":""]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx(N,{href:`/cases/${s.id}`,children:e.jsx(n,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Re,{className:"w-4 h-4"})})}),e.jsx(N,{href:`/cases/${s.id}/edit`,children:e.jsx(n,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Me,{className:"w-4 h-4"})})}),e.jsx(n,{variant:"outline",size:"sm",onClick:()=>je(s.id),className:"h-8 w-8 p-0 text-destructive hover:text-destructive",children:e.jsx(D,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-1",children:[s.is_featured&&e.jsx(S,{variant:"default",className:"text-xs",children:"Featured"}),!s.is_active&&e.jsx(S,{variant:"secondary",className:"text-xs",children:"Inactive"})]})]})]})})]},s.id)})}),l.meta.last_page>1&&e.jsx("div",{className:"flex justify-center",children:e.jsx(Ae,{children:e.jsx(ke,{children:l.links.map((s,t)=>e.jsx(Pe,{children:s.label==="&laquo; Previous"?e.jsx(Oe,{href:s.url||"#",className:s.url?"":"pointer-events-none opacity-50"}):s.label==="Next &raquo;"?e.jsx(ze,{href:s.url||"#",className:s.url?"":"pointer-events-none opacity-50"}):e.jsx(Ee,{href:s.url||"#",isActive:s.active,className:s.url?"":"pointer-events-none opacity-50",children:s.label})},t))})})})]})]}),e.jsx(G,{open:me,onOpenChange:C,children:e.jsxs(K,{children:[e.jsxs(Q,{children:[e.jsx(X,{children:"Are you sure?"}),e.jsx(Y,{children:"This action cannot be undone. This will permanently delete the case and all associated content."})]}),e.jsxs(I,{children:[e.jsx(ee,{children:"Cancel"}),e.jsx(se,{onClick:Ne,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(G,{open:xe,onOpenChange:b,children:e.jsxs(K,{children:[e.jsxs(Q,{children:[e.jsxs(X,{children:["Delete ",i.length," cases?"]}),e.jsx(Y,{children:"This action cannot be undone. This will permanently delete the selected cases and all associated content."})]}),e.jsxs(I,{children:[e.jsx(ee,{children:"Cancel"}),e.jsx(se,{onClick:ve,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete All"})]})]})})]})}export{xs as default};
